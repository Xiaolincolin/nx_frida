# -*- encoding: utf-8 -*-
# @ModuleName: m12_params
# @Function:
# @Author:
# @Time: 2025/7/2 14:12
import base64
from base64 import b64encode

from Cryptodome.Cipher import AES
from Cryptodome.Util.Padding import pad, unpad


def aes_encrypt(plaintext: bytes, key, iv):
    text = pad(plaintext, AES.block_size)
    cipher = AES.new(key, AES.MODE_CBC, iv)
    ct = cipher.encrypt(text)
    return b64encode(ct).decode('utf-8')


def aes_decrypt(ciphertext: bytes, key, iv):
    cipher = AES.new(key, AES.MODE_CBC, iv)
    return unpad(cipher.decrypt(ciphertext), AES.block_size)


def decode_test():
    key_str = "a6 69 b1 56 69 92 21 a7 9c c7 7e ba fa 39 6e d5".replace(' ', '')
    key = bytes.fromhex(key_str)
    iv_str = "28 9b 7f 58 94 c3 44 e0 c6 dd 50 7e 02 66 b3 d2".replace(' ', '')
    iv = bytes.fromhex(iv_str)
    plaintext = base64.b64decode(
        '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'
    )
    ciphertext = aes_decrypt(plaintext, key, iv)
    print(ciphertext.hex())


def encode_test():
    hex_str = "03000000018d6cd466cdb02fbe66f43f7a68b82a5a7a3462d4d473f35829c2f8719c0f402eee1fe43db6f967a8f5c2b0f47341a67fdfcbaddfdec2f84574f956f82b119927b1a385fce44499beed33ec606a6bd42cf671db898d21d7a361faf5d6d5f0d81cec90bf7419ea36ce0501e6a427f7ade33a64eef997cb7e51608d657039972f15f520202ff3eb280d0e264f27920971fdcefc5b48f3a4f726afcb47fbd1169d70ba9b7cdfeb988b1fdc97c1f1665ba33275589d95a5cec424147f3812bc4b078bf80a681ebad05e6525f72dba61fa23b6cc632a31d5863d701ac0fab30920d0c0a0a26febcd8f548317df646ff73b4373eb1320d0bd6b44f7dae578c2fd804265075e49c044a35b50faa82d5b08395c7f1ad8edf82bbd835f057d8c13bc1e5c589ead8fac2d6f7f86c3d575e5021f0303edfc0f09181a39ba46cfb1d5045968bbb71ed2530acb5b5b04e0b86c04ae9f85afcdf0de4c0fef20923fa75d82f2a0f4b54338e6f0b7fcabca79cfa40a32c306c7e78705d8814771f552fb55e639b658e0055228267c97987dac10b4e1005ae4d822e6741036dac98a05edc9da6d05b986a9da2388578c88b7e09f88c707b9b389c0f8d9e274c30be07cad0fe403058f9268515227cf2313aad4a1027bc0f325e3eea2708f9c150f1d4061fb46b8bdab5cd8e7583370809a91679e9fcae607159ca1866027b09f7bfaf03a1615691dbce8e2a6b847480cfd4a9d4cb23547fcc9eb05b5b3433c7a37694a5841b34bce2f80b17d15d5def6187d6b9029df1dec8d7918e8558bda5b73684323c171f6c9961a35cdf99606fe8390834933de846babed23c2d3ea45c2aa83a02819d9d2c8747aeb7fbc852b47dc64841a5d2a2de8e5b2ea05adf8fa3052d3542856da7059f7814384e850f9024d9d8add16653cf9a0944b41fadf7c05820e303049f0dfb82e51edd8a90113cb11f008871704576da01c2f080d57cd60ba015786765cfccddffc54f961aa3597583e665caabe81b13da5ad01c50481bd1db0c1ec463d4d4daabb7bb7a86efc7f118234c069990049e47a32b9b004697f183642b218cd0153271d64e717ed122ddb72e39d2d650a2559b7c7b785bd77e7f4e22075ff0b111e392631cbd1f98df8a9bcd245add3c71cb771a80e4845efda5ba08e875f2d8851e1b64f4005e16c2ae33fbd63a95f729b5b38a9d662b4958a880d2fa532dba073a4947d3fe504629edb5065a025e7e6a10133b740b2de838069d152758b868369781f04ad1aa5cdfb3d8c3625468d7cd4de8f49851bdd0a2cab533caf7f13be3fc91cc5f5b825dba78f615477544c8f9f722015b7ad8715fc20586d4eedf7e379560a8071ce1576f8864fd5c12e5d9a388caf8b79db45a661f5a18aba3b6b9481a109dcc2fba63e75cb6002bb96e21eebfd873db4faaba3e73de61aeaa48727eb483bbb89bda43a2829d4098c58643bd10d0e4902f081e80b4573d3cce13c3a3f4cd6f495f99d407a4c062e4fbae8506eba7afb191c5c8097ac078a336d6c6079c4bae1edbb86ee30c559772f1f0d8dd167b2b89ba663234f479fd045c7dccf6b5e9b0e74d5432b68548d2619e97052db3ba2f1692fd224264f15b53c21fd66e7895b28e135c0e2a018d80a213d7820a3588274c44ec950107ea5929b05db7f79e127404e0ff79635b4cd36edc8fcee602d3cefcd101f953074b259dc5c48bc143191d37780e44409b488770f46b569e1a21932845590e80af43c81552fdb11d9e13e6cb8b6d332722edc36648eb5387942a82c590d33d47faf0a14c1a633cbd75e2805f85edbefd95f0a4801fa7b73075d85d15e108fa14b4db5cb3ad9f49fbec512c05bee9300a1b2df00f9af6f444eeedbe73d3f329f392399c0fd917d2d5d91a05384b3d97c19ec84858a76d35de7dcd8ddb5fa4388fedd67306ca8ea3edf99a1c788fb25335fb03bfdaeb468394677be19a395e493ad559bca797191a36aeffa5084fbd2bcfe1d4dc47cc682f8b876151468b84cdb09c50046e2fc1ebb0db5724d3f004b86193f1808dbcbfba575b5a6ed67e559543562c4c10f2f064eb39b9d5bc312ffdb747d7cde6e4ed76135ec44cc2e3023d8b7474f0958ec0feebbad5c58b80920630cb1e39c15b199b9a2cd819e4f085f3001c05e64dc850e576cd83ab0a732fe3331d23de7c7d8f0d35061b1aaaa8396ffb79d9655dd4134795990147e48e008e199d8d3d72c222eef83b97441a27b8381d2cce23db7778541586dd3afceeb3447443398f23c668d5e8a06ad41397132dd42e2452b2f90ff70459a581842bd783f7dd3b9fefa3e433e3070cef5746213865ea7996eec8e9454bcb7ae370708f5189b5241593d40cd758cc48e3cbfcd3dd84b356b2674e94afeb6afc5562cbeeeb16a89e3c1255ba4e8dd1365ca46269e72403924030b8f08c2532a2d53bf7214d1e4733d04f02a8762fdf48e9082d5022c5e31c2581bf35217d3f50ab28559c7ed79e24d1744db83fc06ae465ceeed1a46ce4d94bb7e2820d7cb8a17ab7c659e2a4d81b1e86c7b12012ca689fae105ba82a83010bc9b3b7c66da84a7b70210548f9dcfc1335655de30c394a0d148af98d87c1c9c763ebdb6421cc1b80e206d91545cb1134a1112b5dd82b22e7e36e8fdf851d9f42c74745b79ca1bfa40734229aefbbab4faeb29a20b1d705c21848174edda789310a1d91140edaad5a5b52d54746c5b7ddb3c8d039ad9a32d03d99af1aea0444fa5063bc7c9a5be9160be6ca7098134f8f33803c4a5714f8d5a8c9a80cb6dbfe344451e14eaebcf0b2fc79275109ff148d262be1c8d816945b91e52822813be480939fb4ffc1a896793f81dd46e689b1bc50d0be3f942bcade24491ff71bd8b094563984b6e5e4a9c192ea5ec5bcd58c720b3c5e962abf843c94acfcc4ea90177d9a41174e40624624303c0dcfe3c223e403b10058d097d9cf9d1ee035bb9b29662f2e171c0c07544f0517ef6b077967a2b50646a22b11ad4f0437b60a7a4aaa9e58596cf8c83510abfda7841a17200eaef94842f4803c2ac2d9448500b73cdf858dbceef776bbae28985838d8aa6fc995deb2d7a56c3ce2747bd505c5256209581a3d89bc07c29404d712d23ae994a981369a16c55be29a2ab939f7aee6a6234fc0ebc4b228a1f2c21ca5576930df3ee79b42c6da090cc3dd7aaf55b5cda061a3322d673307e02f1e61957b9513190517d57aa9d91237ed5e186bacc0b2ba3ec74ed8cd7f120f80ef10a187b4c355c5f3504e2c311e0f25285e5c91a1d3104b370b9fb8135844b42e777f0a69163ea1040ef76e9205a5efec097b659d331ad86d23abf62d5382ee74841c2f70b98a728e24210460eb274ca2cbfb3079fd825ca4552ad349ebefee338c4bb199ccfab79f3e04ee727ab5f63938c2f5032147d945f525c353d72e076141346ddb62787f43f8edceeb1cee3d1b8649d777511d113f64c996839a303dea888d22517f17d75a087e5711d9497e3dce481c919799fc33bc47adeec71c73c5967a043b90382f06c60686fcd28f5"
    plaintext = bytes.fromhex(hex_str)
    key_str = "01 64 9a 8b b3 65 f7 23 ef 61 7d b8 dc 54 38 5e".replace(' ', '')
    key = bytes.fromhex(key_str)
    iv_str = "69 24 fa 69 63 22 65 19 f3 7e b3 02 06 3f 11 b5".replace(' ', '')
    iv = bytes.fromhex(iv_str)
    result = aes_encrypt(plaintext, key, iv)
    print(result)


if __name__ == '__main__':
    encode_test()
